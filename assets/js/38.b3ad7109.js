(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{782:function(e,t,a){"use strict";a.r(t);var r=a(51),_=Object(r.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("p",[e._v("关于 Jenkins REST api部分，结合 "),a("a",{attrs:{href:"https://www.jenkins.io/doc/book/using/remote-access-api/",target:"_blank",rel:"noopener noreferrer"}},[e._v("官方文档"),a("OutboundLink")],1),e._v("和自身实践做一个的总结。")]),e._v(" "),a("h2",{attrs:{id:"api类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#api类型"}},[e._v("->")]),e._v(" API类型")]),e._v(" "),a("p",[e._v("Jenkins 提供了三种风格的 API类型。")]),e._v(" "),a("ol",[a("li",[e._v("XML\n"),a("ul",[a("li",[e._v("即接口返回内容为 xml, eg："),a("code",[e._v("http://<JENKINS_HOST>/config.xml")])])])]),e._v(" "),a("li",[e._v("JSON 以及 JSONP 支持\n"),a("ul",[a("li",[e._v("接口返回内容格式还可以为 JSON, eg: "),a("code",[e._v("http://<JENKINS_HOST>/api")])]),e._v(" "),a("li",[e._v("JSONP 的例子没有给，查了下似乎需要装个 "),a("a",{attrs:{href:"https://github.com/jenkinsci/secure-requester-whitelist-plugin",target:"_blank",rel:"noopener noreferrer"}},[e._v("secure-requester-whitelist"),a("OutboundLink")],1),e._v("插件使生效")])])]),e._v(" "),a("li",[e._v("Python\n"),a("ul",[a("li",[e._v("通过 "),a("code",[e._v('ast.literal_eval(urllib.urlopen("JENKINS_URL").read())')]),e._v(" 将远程输出解析成一个 Python对象")])])])]),e._v(" "),a("p",[e._v("第三种效率不是很高，目前看到的封装库也都是对前两种 API的封装")]),e._v(" "),a("h2",{attrs:{id:"接口列表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#接口列表"}},[e._v("->")]),e._v(" 接口列表")]),e._v(" "),a("p",[e._v("官方文档没有给出所有接口的一个列表，需要开发者自己分页面去寻找……"),a("br"),e._v("\n这里以 JSON接口为主，xml接口为辅总结所有接口。"),a("br"),e._v("\n接口前缀默认为 "),a("code",[e._v("http://<JENKINS_HOST>")])]),e._v(" "),a("h3",{attrs:{id:"首页"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#首页"}},[e._v("->")]),e._v(" 首页")]),e._v(" "),a("p",[e._v("通过 "),a("code",[e._v("http://<JENKINS_HOST>/api")]),e._v("页面查看")]),e._v(" "),a("h4",{attrs:{id:"获取首页目录信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取首页目录信息"}},[e._v("->")]),e._v(" 获取首页目录信息")]),e._v(" "),a("p",[a("code",[e._v("GET /api/json")])]),e._v(" "),a("h3",{attrs:{id:"任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#任务"}},[e._v("->")]),e._v(" 任务")]),e._v(" "),a("p",[e._v("通过 "),a("code",[e._v("http://<JENKINS_HOST>/job/JobName/api")]),e._v("页面查看")]),e._v(" "),a("h4",{attrs:{id:"创建任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建任务"}},[e._v("->")]),e._v(" 创建任务")]),e._v(" "),a("p",[a("code",[e._v("POST /createItem?name=<JOBNAME>")])]),e._v(" "),a("ul",[a("li",[e._v("header: "),a("code",[e._v("Content-Type: application/xml")])]),e._v(" "),a("li",[e._v("body: "),a("code",[e._v("config.xml")])])]),e._v(" "),a("h4",{attrs:{id:"复制任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#复制任务"}},[e._v("->")]),e._v(" 复制任务")]),e._v(" "),a("p",[a("code",[e._v("POST /createItem?name=<NEWJOBNAME>&mode=copy&from=<FROMJOBNAME>")])]),e._v(" "),a("h4",{attrs:{id:"获取-更新任务配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取-更新任务配置"}},[e._v("->")]),e._v(" 获取/更新任务配置")]),e._v(" "),a("p",[a("code",[e._v("POST /job/<JOBNAME>/config.xml")]),a("br"),e._v(" "),a("code",[e._v("POST /job/<JOBNAME>/config.xml")]),e._v(", 参数为 "),a("code",[e._v("更新后的cofig.xml")])]),e._v(" "),a("h4",{attrs:{id:"获取多分支任务列表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取多分支任务列表"}},[e._v("->")]),e._v(" 获取多分支任务列表")]),e._v(" "),a("p",[a("code",[e._v("GET /job/<JOBNAME>/api/json")])]),e._v(" "),a("h4",{attrs:{id:"删除任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除任务"}},[e._v("->")]),e._v(" 删除任务")]),e._v(" "),a("p",[a("code",[e._v("POST /job/<JOBNAME>/doDelete")])]),e._v(" "),a("h4",{attrs:{id:"获取当前任务-分支任务所有构建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取当前任务-分支任务所有构建"}},[e._v("->")]),e._v(" 获取当前任务|分支任务所有构建")]),e._v(" "),a("p",[e._v("默认包含最近 50次构建\n"),a("code",[e._v("POST /job/<JOBNAME>/job/<BranchName>/api/json")])]),e._v(" "),a("h4",{attrs:{id:"更新任务描述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更新任务描述"}},[e._v("->")]),e._v(" 更新任务描述")]),e._v(" "),a("p",[a("code",[e._v("POST /job/<JOBNAME>/job/<BranchName>/description")]),e._v("\n参数类型为"),a("code",[e._v("form-data")]),e._v(", description=xxx")]),e._v(" "),a("h4",{attrs:{id:"构建任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#构建任务"}},[e._v("->")]),e._v(" 构建任务")]),e._v(" "),a("p",[e._v("无参数构建\n"),a("code",[e._v("POST /job/<JOBNAME>/job/<BranchName>/build")]),a("br"),e._v("\n带参数构建为：\n"),a("code",[e._v("POST /job/<JOBNAME>/job/<BranchName>/buildWithParameters")]),e._v(", 参数形式为 "),a("code",[e._v("form data")])]),e._v(" "),a("h3",{attrs:{id:"节点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#节点"}},[e._v("->")]),e._v(" 节点")]),e._v(" "),a("p",[e._v("通过 "),a("code",[e._v("http://client-ci.oa.com/computer/api")]),e._v("及 "),a("code",[e._v("http://client-ci.oa.com/computer/<DisplayName>/api")]),e._v(" 页面查看")]),e._v(" "),a("h4",{attrs:{id:"获取所有节点信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取所有节点信息"}},[e._v("->")]),e._v(" 获取所有节点信息")]),e._v(" "),a("p",[a("code",[e._v("GET /computer/api/json")])]),e._v(" "),a("h4",{attrs:{id:"获取特定节点信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取特定节点信息"}},[e._v("->")]),e._v(" 获取特定节点信息")]),e._v(" "),a("p",[a("code",[e._v("GET /computer/<DisplayName>/api/json")])]),e._v(" "),a("h4",{attrs:{id:"获取-更新节点配置信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取-更新节点配置信息"}},[e._v("->")]),e._v(" 获取/更新节点配置信息")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("GET /computer/<DisplayName>/config.xml")])]),e._v(" "),a("li",[a("code",[e._v("POST /computer/<DisplayName>/config.xml")]),e._v(", 参数为 "),a("code",[e._v("更新后的config.xml")])])]),e._v(" "),a("h3",{attrs:{id:"队列"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#队列"}},[e._v("->")]),e._v(" 队列")]),e._v(" "),a("p",[e._v("通过 "),a("code",[e._v("http://<JENKINS_HOST>/queue/api/")]),e._v("页面查看")]),e._v(" "),a("h4",{attrs:{id:"获取所有排队任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取所有排队任务"}},[e._v("->")]),e._v(" 获取所有排队任务")]),e._v(" "),a("p",[a("code",[e._v("GET /queue/api/json")])]),e._v(" "),a("ul",[a("li",[e._v("可以通过 tree参数进行数组过滤，eg：\n"),a("ul",[a("li",[a("code",[e._v("GET /queue/api/json?tree=items[actions[causes[shortDescription]]]")])])])]),e._v(" "),a("li",[e._v("可以对数组结果进行数量筛选 eg: "),a("code",[e._v("tree=arrs[attr1, attr2]{0,10}")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("{M,N}")]),e._v(": From the M-th element (inclusive) to the N-th element (exclusive).")]),e._v(" "),a("li",[a("code",[e._v("{M,}")]),e._v(": From the M-th element (inclusive) to the end.")]),e._v(" "),a("li",[a("code",[e._v("{,N}")]),e._v(": From the first element (inclusive) to the N-th element (exclusive). The same as {0,N}.")]),e._v(" "),a("li",[a("code",[e._v("{N}")]),e._v(": Just retrieve the N-th element. The same as {N,N+1}.")])])])]),e._v(" "),a("h3",{attrs:{id:"pipeline"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pipeline"}},[e._v("->")]),e._v(" Pipeline")]),e._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/jenkinsci/pipeline-stage-view-plugin/tree/master/rest-api#get-jobjob-namewfapiruns",target:"_blank",rel:"noopener noreferrer"}},[e._v("Pipeline REST api"),a("OutboundLink")],1)]),e._v(" "),a("h2",{attrs:{id:"参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[e._v("->")]),e._v(" 参考")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://opendev.org/jjb/python-jenkins/src/branch/master/jenkins/__init__.py",target:"_blank",rel:"noopener noreferrer"}},[e._v("python-jenkins"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://support.cloudbees.com/hc/en-us/articles/360030526992-How-to-manage-Credentials-via-the-REST-API",target:"_blank",rel:"noopener noreferrer"}},[e._v("manage-Credentials"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=_.exports}}]);