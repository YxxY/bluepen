---
title: Java 基本数据类型
permalink: java/primitive-type
date: 2019-07-15
---

Java 作为强类型语言, 数据类型也分为基本类型(primitive type)和对象类型(object)

## 基本类型
在 Java中一共有 8 种基本类型:
- 4 种整型(byte, short, int, long)
- 2 种浮点型(float, double)
- 1 种字符类型(char)
- 1 种表示真值的布尔类型(boolean)

### 整型
整型均为**有符号的**, 且为了保证可移植性, 均为固定长度
type| bytes| range
----|------|------
byte|   1 字节| -128 ~ 127
short| 2 字节| -32768 ~ 32767
int| 4 字节| -2^31 ~ 2^31 - 1 (20亿)
long| 8 字节| -2^63 ~ 2^63 - 1 (9亿亿)

::: tip
Java 7 开始, 
- 前缀 0b或 0B可以表示二进制数
    eg: 0b1001 表示9
- 数字可以添加下划线增加可读性
    eg: 1_000_000 表示一百万
:::

### 浮点类型

type| bytes|
----|------|------
float|   4 字节|
double|   8字节|

float类型会带有后缀 F或f, eg: 3.14f, 6.28F  
没有后缀默认 double类型, 也可以加上后缀 D或d

#### 十六进制表示法:
0.125 = 2^-3 = 0x1.0p-3  
p表示指数, 而不是 e, 基数为 2, 而不是 10

#### 特殊值
浮点数有三个特殊值:
- 正无穷大 (Double.POSITIVE_INFINITY)
    - eg: 整数除以0
- 负无穷大 (Double.NEGATIVE_INFINITY)
- NaN (Double.NaN)
    - eg: 0/0, 负数的平方根
值得注意的是, NaN 不等于 NaN 自身
判断一个数是否为 NaN 可以使用 Double对象的 isNaN方法
```java
if(Double.isNaN(x))
```

::: warning
浮点数采用二进制存储, 二进制无法精确的表示 1/10, 因此使用浮点数计算时可能会有一些舍入误差.
如果有精确计算的需求, 应该使用 BigDecimal类
:::

## 字符类型
char 类型用于表示单个字符. 
type| bytes|
----|------|
char|   2 字节|

Unicode中每一个字符对应着一个**码点**(code point)， **一个码点包含一到多个代码单元**  
char 类型描述了 UTF-16编码中的一个**代码单元** (code unit).  
因此, 一个字符通常可以用一个 char值表示, 随着 unicode的扩充, 一些字符需要使用 2个 char值.  
    
在 Java中不建议使用该类型, 除非是确实需要处理字符的代码单元, 其他最好直接使用字符串

## 布尔类型
boolean 类型只有两个值, false 和 true.
::: warning
与 C语言中 0即为false不同, Java 中整型值和布尔值不能相互转换
:::

有意思的是, 这里对于布尔类型占用的字节数这里没有做说明.  
查阅资料比较多的说法是, 作为单个的布尔变量, 占用大小和 int是一样的, 也就是 4字节, 而存储布尔数组时, 每一个值会被作为 byte来处理, 即 1字节.  
我觉得没必要纠结这里的细节, 知道这个好像也没有带来什么技术提升, 了解即可

## 数值类型转换
当两个不同类型数值进行二元计算时, 两个操作值会先被转换成同一类型, 在进行计算
转换的规则依次为:
1. 存在 double类型, 则转换为 double类型
2. 上一条不成立, 存在 float类型, 转换为 float类型
3. 上两条不成立, 存在 long类型, 转换为 long类型
4. 上面规则均不成立时, 两个操作数均转化为 int类型

举例说明, 证明规则1和4, eg:
```java
public class TestIntegerCast{
    public static void main(String[] args){a
        byte a = 10;
        short b = 128;
        double c = 9.9;

        System.out.println(getType(a)); //class java.lang.Byte
        System.out.println(getType(b)); //class java.lang.Short
        System.out.println(getType(a+b)); //class java.lang.Integer
        System.out.println(a+c); //19.9
        System.out.println(getType(a+c)); //class java.lang.Double
    }

    public static String getType(Object o){
        return o.getClass().toString();
    } 
}
```

## 强制转类型换
从上文可知, int型数字和 double类型二元计算时, int会被转换为 double类型。但也有一些场景需要将 double类型转换为 int类型。因此，引入**强制类型转换**(cast)操作。
eg:
```java
double x = 9.9;
int a = (int) x;
```
通过括号加类型的方式可实现类型转换操作, 同时, 浮点型转换成整型的规则是: 直接去掉小数部分，并非想当然的四舍五入。 故上述例子中，变量a的值为 9  
如果要实现“四舍五入”式的转换，可使用 `Math.round`方法，需要注意的是：`Math.round`方法值为 long类型，因此结果仍然需要进行强制类型转换，eg：
```java
double x = 9.9;
int a = (int) Math.round(x); //10
```

## 参考
- Java 核心技术卷一: 3.3, 3.5
